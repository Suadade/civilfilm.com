---
const accept = (Astro.request.headers.get("accept-language") ?? "").toLowerCase();
const langs = accept
  .split(",")
  .map((part) => part.split(";")[0].trim())
  .filter(Boolean);

const prefersSvHeader = langs.some((l) => l === "sv" || l.startsWith("sv-"));
const prefersEnHeader = langs.some((l) => l === "en" || l.startsWith("en-"));

// If header clearly indicates sv/en, do a server redirect.
if (prefersSvHeader) return Astro.redirect("/sv/", 302);
if (prefersEnHeader) return Astro.redirect("/en/", 302);
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Civilfilm</title>
    <script>
      (function () {
        const langs = (navigator.languages && navigator.languages.length)
          ? navigator.languages
          : [navigator.language || "en"];

        const prefersSv = langs.some(l => (l || "").toLowerCase().startsWith("sv"));
        window.location.replace(prefersSv ? "/sv/" : "/en/");
      })();
    </script>
  </head>
  <body></body>
</html>
